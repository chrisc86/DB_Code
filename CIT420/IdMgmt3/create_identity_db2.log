SQL> SET FEEDBACK ON
SQL> SET NULL '<Null>'
SQL> SET PAGESIZE 999
SQL> SET SERVEROUTPUT ON
SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create SYSTEM_USER table and sequence and seed data.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'SYSTEM_USER') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE system_user CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'SYSTEM_USER_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE system_user_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE system_user
  2  ( system_user_id		   NUMBER	CONSTRAINT pk_su1 PRIMARY KEY
  3  , system_user_name 	   VARCHAR2(20) CONSTRAINT nn_su1 NOT NULL
  4  , system_user_password	   VARCHAR2(40) CONSTRAINT nn_su2 NOT NULL
  5  , system_user_group_id	   NUMBER	CONSTRAINT nn_su3 NOT NULL
  6  , start_date		   DATE 	CONSTRAINT nn_su4 NOT NULL
  7  , end_date 		   DATE
  8  , last_name		   VARCHAR2(20)
  9  , first_name		   VARCHAR2(20)
 10  , middle_initial		   VARCHAR2(1)
 11  , created_by		   NUMBER	CONSTRAINT nn_su5 NOT NULL
 12  , creation_date		   DATE 	CONSTRAINT nn_su6 NOT NULL
 13  , last_updated_by		   NUMBER	CONSTRAINT nn_su7 NOT NULL
 14  , last_update_date 	   DATE 	CONSTRAINT nn_su8 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE system_user_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> -- Seed an authorized user.
SQL> INSERT INTO system_user
  2  ( system_user_id
  3  , system_user_name
  4  , system_user_password
  5  , system_user_group_id
  6  , start_date
  7  , created_by
  8  , creation_date
  9  , last_updated_by
 10  , last_update_date)
 11  VALUES
 12  ( 1
 13  ,'administrator'
 14  ,'c0b137fe2d792459f26ff763cce44574a5b5ab03'
 15  , 0
 16  , SYSDATE
 17  , 1
 18  , SYSDATE
 19  , 1
 20  , SYSDATE);

1 row created.

SQL> 
SQL> -- Seed an authorized user.
SQL> INSERT INTO system_user
  2  ( system_user_id
  3  , system_user_name
  4  , system_user_password
  5  , system_user_group_id
  6  , start_date
  7  , created_by
  8  , creation_date
  9  , last_updated_by
 10  , last_update_date)
 11  VALUES
 12  ( 2
 13  ,'guest'
 14  ,'35675e68f4b5af7b995d9205ad0fc43842f16450'
 15  , 1
 16  , SYSDATE
 17  , 1
 18  , SYSDATE
 19  , 1
 20  , SYSDATE);

1 row created.

SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create SYSTEM_USER table and sequence.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'SYSTEM_SESSION') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE system_session CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'SYSTEM_SESSION_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE system_session_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE system_session
  2  ( system_session_id	   NUMBER	CONSTRAINT pk_ss1 PRIMARY KEY
  3  , system_session_number	   VARCHAR2(30) CONSTRAINT nn_ss1 NOT NULL
  4  , system_remote_address	   VARCHAR2(15) CONSTRAINT nn_ss2 NOT NULL
  5  , system_user_id		   NUMBER	CONSTRAINT nn_ss3 NOT NULL
  6  , created_by		   NUMBER	CONSTRAINT nn_ss4 NOT NULL
  7  , creation_date		   DATE 	CONSTRAINT nn_ss5 NOT NULL
  8  , last_updated_by		   NUMBER	CONSTRAINT nn_ss6 NOT NULL
  9  , last_update_date 	   DATE 	CONSTRAINT nn_ss7 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE system_session_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create INVALID_SESSION table and sequence.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'INVALID_SESSION') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE invalid_session CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'INVALID_SESSION_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE invalid_session_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE invalid_session
  2  ( invalid_session_id	   NUMBER	CONSTRAINT pk_is1 PRIMARY KEY
  3  , invalid_session_number	   VARCHAR2(30) CONSTRAINT nn_is1 NOT NULL
  4  , invalid_remote_address	   VARCHAR2(15) CONSTRAINT nn_is2 NOT NULL
  5  , created_by		   NUMBER	CONSTRAINT nn_is3 NOT NULL
  6  , creation_date		   DATE 	CONSTRAINT nn_is4 NOT NULL
  7  , last_updated_by		   NUMBER	CONSTRAINT nn_is5 NOT NULL
  8  , last_update_date 	   DATE 	CONSTRAINT nn_is6 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE invalid_session_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create ACTIVITY_HISTORY table and sequence.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'ACTIVITY_HISTORY') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE activity_history CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'ACTIVITY_HISTORY_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE activity_history_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE activity_history
  2  ( activity_history_id	   NUMBER	CONSTRAINT pk_ah1 PRIMARY KEY
  3  , activity_module_name	   VARCHAR2(30) CONSTRAINT nn_ah1 NOT NULL
  4  , actual_module_id 	   NUMBER	CONSTRAINT nn_ah2 NOT NULL
  5  , defined_module_id	   NUMBER	CONSTRAINT nn_ah3 NOT NULL
  6  , created_by		   NUMBER	CONSTRAINT nn_ah4 NOT NULL
  7  , creation_date		   DATE 	CONSTRAINT nn_ah5 NOT NULL
  8  , last_updated_by		   NUMBER	CONSTRAINT nn_ah6 NOT NULL
  9  , last_update_date 	   DATE 	CONSTRAINT nn_ah7 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE activity_history_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create DEFINED_MODULE table and sequence.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'DEFINED_MODULE') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE defined_module CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'DEFINED_MODULE_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE defined_module_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE defined_module
  2  ( defined_modual_id	   NUMBER	CONSTRAINT pk_dm1 PRIMARY KEY
  3  , defined_modual_name	   VARCHAR2(30) CONSTRAINT nn_dm1 NOT NULL
  4  , start_date		   DATE 	CONSTRAINT nn_dm2 NOT NULL
  5  , end_date 		   DATE 	CONSTRAINT nn_dm3 NOT NULL
  6  , created_by		   NUMBER	CONSTRAINT nn_dm4 NOT NULL
  7  , creation_date		   DATE 	CONSTRAINT nn_dm5 NOT NULL
  8  , last_updated_by		   NUMBER	CONSTRAINT nn_dm6 NOT NULL
  9  , last_update_date 	   DATE 	CONSTRAINT nn_dm7 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE defined_module_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create FORMAL_PARAMETER table and sequence.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'FORMAL_PARAMETER') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE formal_parameter CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'FORMAL_PARAMETER_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE formal_parameter_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE formal_parameter
  2  ( formal_parameter_id	   NUMBER	CONSTRAINT pk_fp1 PRIMARY KEY
  3  , formal_parameter_name	   VARCHAR2(30) CONSTRAINT nn_fp1 NOT NULL
  4  , formal_parameter_type	   VARCHAR2(30) CONSTRAINT nn_fp2 NOT NULL
  5  , start_date		   DATE 	CONSTRAINT nn_fp3 NOT NULL
  6  , end_date 		   DATE 	CONSTRAINT nn_fp4 NOT NULL
  7  , created_by		   NUMBER	CONSTRAINT nn_fp5 NOT NULL
  8  , creation_date		   DATE 	CONSTRAINT nn_fp6 NOT NULL
  9  , last_updated_by		   NUMBER	CONSTRAINT nn_fp7 NOT NULL
 10  , last_update_date 	   DATE 	CONSTRAINT nn_fp8 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE formal_parameter_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create ACTUAL_MODULE table and sequence.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'ACTUAL_MODULE') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE actual_module CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'ACTUAL_MODULE_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE actual_module_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE actual_module
  2  ( actual_modual_id 	   NUMBER	CONSTRAINT pk_am1 PRIMARY KEY
  3  , actual_modual_name	   VARCHAR2(30) CONSTRAINT nn_am1 NOT NULL
  4  , start_date		   DATE 	CONSTRAINT nn_am2 NOT NULL
  5  , end_date 		   DATE 	CONSTRAINT nn_am3 NOT NULL
  6  , created_by		   NUMBER	CONSTRAINT nn_am4 NOT NULL
  7  , creation_date		   DATE 	CONSTRAINT nn_am5 NOT NULL
  8  , last_updated_by		   NUMBER	CONSTRAINT nn_am6 NOT NULL
  9  , last_update_date 	   DATE 	CONSTRAINT nn_am7 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE actual_module_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create ACTUAL_PARAMETER table and sequence.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'ACTUAL_PARAMETER') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE actual_parameter CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'ACTUAL_PARAMETER_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE actual_parameter_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE actual_parameter
  2  ( actual_parameter_id	   NUMBER	CONSTRAINT pk_ap1 PRIMARY KEY
  3  , actual_parameter_name	   VARCHAR2(30) CONSTRAINT nn_ap1 NOT NULL
  4  , actual_parameter_type	   VARCHAR2(30) CONSTRAINT nn_ap2 NOT NULL
  5  , start_date		   DATE 	CONSTRAINT nn_ap3 NOT NULL
  6  , end_date 		   DATE 	CONSTRAINT nn_ap4 NOT NULL
  7  , created_by		   NUMBER	CONSTRAINT nn_ap5 NOT NULL
  8  , creation_date		   DATE 	CONSTRAINT nn_ap6 NOT NULL
  9  , last_updated_by		   NUMBER	CONSTRAINT nn_ap7 NOT NULL
 10  , last_update_date 	   DATE 	CONSTRAINT nn_ap8 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE actual_parameter_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'COMMON_LOOKUP') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE common_lookup CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'COMMON_LOOKUP_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE common_lookup_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create ITEM_CATALOG table and sequence.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> -- Conditionally drop objects.
SQL> BEGIN
  2    FOR i IN (SELECT null
  3  		 FROM	user_tables
  4  		 WHERE	table_name = 'ITEM_CATALOG') LOOP
  5  	 EXECUTE IMMEDIATE 'DROP TABLE item_catalog CASCADE CONSTRAINTS';
  6    END LOOP;
  7    FOR i IN (SELECT null
  8  		 FROM	user_sequences
  9  		 WHERE	sequence_name = 'ITEM_CATALOG_S1') LOOP
 10  	 EXECUTE IMMEDIATE 'DROP SEQUENCE item_catalog_s1';
 11    END LOOP;
 12  END;
 13  /

PL/SQL procedure successfully completed.

SQL> 
SQL> -- Create table.
SQL> CREATE TABLE item_catalog
  2  ( item_catalog_id		   NUMBER	CONSTRAINT pk_ic1 PRIMARY KEY
  3  , item_catalog_type	   VARCHAR2(30) CONSTRAINT nn_ic1  NOT NULL
  4  , item_name		   VARCHAR2(30) CONSTRAINT nn_ic2  NOT NULL
  5  , item_description 	   VARCHAR2(80) CONSTRAINT nn_ic3  NOT NULL
  6  , inventory_item_id	   NUMBER	CONSTRAINT nn_ic4  NOT NULL
  7  , start_date		   DATE 	CONSTRAINT nn_ic5  NOT NULL
  8  , end_date 		   DATE 	CONSTRAINT nn_ic6  NOT NULL
  9  , created_by		   NUMBER	CONSTRAINT nn_ic7  NOT NULL
 10  , creation_date		   DATE 	CONSTRAINT nn_ic8  NOT NULL
 11  , last_updated_by		   NUMBER	CONSTRAINT nn_ic9  NOT NULL
 12  , last_update_date 	   DATE 	CONSTRAINT nn_ic10 NOT NULL);

Table created.

SQL> 
SQL> -- Create sequence.
SQL> CREATE SEQUENCE item_catalog_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> 
SQL> -- ------------------------------------------------------------------
SQL> -- Create COMMON_LOOKUP table and sequence and seed data.
SQL> -- ------------------------------------------------------------------
SQL> 
SQL> CREATE TABLE common_lookup
  2  ( common_lookup_id 	   NUMBER	CONSTRAINT pk_cl1 PRIMARY KEY
  3  , common_lookup_context	   VARCHAR2(30) CONSTRAINT nn_cl1 NOT NULL
  4  , common_lookup_type	   VARCHAR2(30) CONSTRAINT nn_cl2 NOT NULL
  5  , common_lookup_meaning	   VARCHAR2(30) CONSTRAINT nn_cl3 NOT NULL
  6  , created_by		   NUMBER	CONSTRAINT nn_cl4 NOT NULL
  7  , creation_date		   DATE 	CONSTRAINT nn_cl5 NOT NULL
  8  , last_updated_by		   NUMBER	CONSTRAINT nn_cl6 NOT NULL
  9  , last_update_date 	   DATE 	CONSTRAINT nn_cl7 NOT NULL);

Table created.

SQL> 
SQL> CREATE SEQUENCE common_lookup_s1 START WITH 1001;

Sequence created.

SQL> 
SQL> INSERT INTO common_lookup VALUES
  2  ( 0,'SYSTEM_USER','SYSTEM_ADMIN','System Administrator'
  3  , 1, SYSDATE, 1, SYSDATE);

1 row created.

SQL> 
SQL> INSERT INTO common_lookup VALUES
  2  ( 1,'SYSTEM_USER','END_USER','System User'
  3  , 1, SYSDATE, 1, SYSDATE);

1 row created.

SQL> 
SQL> CREATE OR REPLACE VIEW authorized_user AS
  2    SELECT	su.system_user_id AS user_id
  3    ,	su.system_user_name AS user_name
  4    ,	cl.common_lookup_meaning AS user_privilege
  5    ,	CASE
  6  		  WHEN su.first_name IS NOT NULL AND  su.last_name IS NOT NULL
  7  		  THEN su.last_name||', '|| su.first_name
  8  		  ELSE NULL
  9  		END AS employee_name
 10    ,	su.system_user_group_id AS group_id
 11    FROM	system_user su JOIN common_lookup cl
 12    ON	su.system_user_group_id = cl.common_lookup_id
 13    WHERE	TO_NUMBER(NVL(SYS_CONTEXT('userenv','client_info'),-1)) = 0
 14    OR	su.system_user_id =
 15  		  TO_NUMBER(NVL(SYS_CONTEXT('userenv','client_info'),-1))
 16    ORDER BY CASE
 17  		  WHEN first_name IS NULL
 18  		  THEN 0
 19  		  ELSE 1
 20  		END
 21    ,	su.last_name
 22    ,	su.first_name
 23    ,	su.system_user_id;

View created.

SQL> 
SQL> -- Commit the records.
SQL> COMMIT;

Commit complete.

SQL> 
SQL> -- Close script output file.
SQL> SPOOL OFF
